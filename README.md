# Personal Knowledge MCP Server

ä¸ªäººçŸ¥è¯†åº“ MCP æœåŠ¡å™¨ - å°†æœ¬åœ°æ–‡æ¡£ã€é£ä¹¦ã€ä¼ä¸šå¾®ä¿¡æ–‡æ¡£ç»Ÿä¸€ç´¢å¼•ï¼Œé€šè¿‡ MCP åè®®æä¾›ç»™ AI å®¢æˆ·ç«¯ï¼ˆå¦‚ Cherry Studioï¼‰è®¿é—®ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

**Phase 1 (å·²å®ç°)**
- âœ… æœ¬åœ°æ–‡æ¡£ç´¢å¼•ï¼ˆæ”¯æŒ TXT, MD, PDF, DOCX, PPTXï¼‰
- âœ… å…¨æ–‡æœç´¢ï¼ˆSQLite FTS5ï¼‰
- âœ… MCP åè®®æ¥å£
- âœ… æ–‡æ¡£å…ƒæ•°æ®ç®¡ç†

**Phase 2-3 (è§„åˆ’ä¸­)**
- ğŸš§ é£ä¹¦æ–‡æ¡£åŒæ­¥
- ğŸš§ ä¼ä¸šå¾®ä¿¡æ–‡æ¡£åŒæ­¥
- ğŸš§ è¯­ä¹‰æœç´¢ï¼ˆå‘é‡åŒ–ï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd personal-knowledge-mcp
npm install
```

### 2. é…ç½®

ç¼–è¾‘ `config.json`ï¼Œè®¾ç½®ä½ æƒ³è¦ç´¢å¼•çš„æ–‡æ¡£è·¯å¾„ï¼š

```json
{
  "local": {
    "enabled": true,
    "watch_paths": [
      "~/Documents",
      "~/Desktop"
    ],
    "file_extensions": [".txt", ".md", ".pdf", ".docx"],
    "exclude_patterns": [
      "**/node_modules/**",
      "**/.git/**"
    ]
  },
  "database": {
    "path": "./data/knowledge.db"
  }
}
```

### 3. æ„å»ºé¡¹ç›®

```bash
npm run build
```

### 4. ç´¢å¼•æœ¬åœ°æ–‡æ¡£

```bash
npm run index
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
å¼€å§‹æ‰«ææœ¬åœ°æ–‡æ¡£...
æ‰«æç›®å½•: ~/Documents
æ‰¾åˆ° 45 ä¸ª .md æ–‡ä»¶
æ‰¾åˆ° 12 ä¸ª .pdf æ–‡ä»¶
æ­£åœ¨ä¿å­˜ 57 ä¸ªæ–‡æ¡£åˆ°æ•°æ®åº“...
ç´¢å¼•å®Œæˆï¼

æ•°æ®åº“ç»Ÿè®¡:
  local: 57 ä¸ªæ–‡æ¡£
```

### 5. é…ç½® Cherry Studio

åœ¨ Cherry Studio ä¸­æ·»åŠ  MCP Serverï¼š

**æ–¹æ³• 1: é€šè¿‡ UI é…ç½®**
1. æ‰“å¼€ Cherry Studio è®¾ç½®
2. æ‰¾åˆ° "MCP Servers" æˆ– "Model Context Protocol"
3. æ·»åŠ æ–°çš„ Server
4. é…ç½®å¦‚ä¸‹ï¼š

```json
{
  "personal-knowledge": {
    "command": "node",
    "args": ["/path/to/personal-knowledge-mcp/dist/index.js"],
    "cwd": "/path/to/personal-knowledge-mcp"
  }
}
```

**æ–¹æ³• 2: ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶**

æ‰¾åˆ° Cherry Studio çš„é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸åœ¨ `~/.cherry-studio/config.json` æˆ–åº”ç”¨è®¾ç½®ç›®å½•ï¼‰ï¼Œæ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "personal-knowledge": {
      "command": "node",
      "args": ["/path/to/personal-knowledge-mcp/dist/index.js"],
      "cwd": "/path/to/personal-knowledge-mcp"
    }
  }
}
```

### 6. åœ¨ Cherry Studio ä¸­ä½¿ç”¨

é‡å¯ Cherry Studio åï¼Œä½ å¯ä»¥åœ¨å¯¹è¯ä¸­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è®¿é—®çŸ¥è¯†åº“ï¼š

```
è¯·å¸®æˆ‘æœç´¢çŸ¥è¯†åº“ä¸­å…³äº"TypeScript æ³›å‹"çš„æ–‡æ¡£
```

AI ä¼šè‡ªåŠ¨è°ƒç”¨ `search_documents` å·¥å…·è¿›è¡Œæœç´¢ã€‚

## ğŸ› ï¸ MCP å·¥å…·åˆ—è¡¨

æœåŠ¡å™¨æä¾›ä»¥ä¸‹ MCP å·¥å…·ï¼š

### 1. `search_documents`
æœç´¢çŸ¥è¯†åº“ä¸­çš„æ–‡æ¡£

**å‚æ•°:**
- `query` (å¿…å¡«): æœç´¢å…³é”®è¯
- `source` (å¯é€‰): é™å®šæ¥æº ('local', 'feishu', 'wecom')
- `limit` (å¯é€‰): è¿”å›æ•°é‡ï¼Œé»˜è®¤ 20

**ç¤ºä¾‹:**
```json
{
  "query": "React Hooks",
  "source": "local",
  "limit": 10
}
```

### 2. `get_document`
è·å–å®Œæ•´æ–‡æ¡£å†…å®¹

**å‚æ•°:**
- `document_id` (å¿…å¡«): æ–‡æ¡£ ID

### 3. `list_documents`
åˆ—å‡ºæ‰€æœ‰æ–‡æ¡£

**å‚æ•°:**
- `source` (å¯é€‰): é™å®šæ¥æº
- `limit` (å¯é€‰): è¿”å›æ•°é‡ï¼Œé»˜è®¤ 50

### 4. `get_stats`
è·å–çŸ¥è¯†åº“ç»Ÿè®¡ä¿¡æ¯

**è¿”å›ç¤ºä¾‹:**
```json
{
  "stats": {
    "local": 57,
    "feishu": 0,
    "wecom": 0
  }
}
```

### 5. `sync_local_documents`
æ‰‹åŠ¨è§¦å‘æœ¬åœ°æ–‡æ¡£åŒæ­¥

## ğŸ“ é¡¹ç›®ç»“æ„

```
personal-knowledge-mcp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ server.ts             # MCP Server å®ç°
â”‚   â”œâ”€â”€ types.ts              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ storage/
â”‚   â”‚   â””â”€â”€ database.ts       # SQLite æ•°æ®åº“ç®¡ç†
â”‚   â”œâ”€â”€ crawlers/
â”‚   â”‚   â””â”€â”€ local-crawler.ts  # æœ¬åœ°æ–‡æ¡£çˆ¬è™«
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ file-parser.ts    # æ–‡ä»¶è§£æå™¨
â”œâ”€â”€ data/
â”‚   â””â”€â”€ knowledge.db          # SQLite æ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ config.json               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: ç´¢å¼•é€Ÿåº¦æ…¢ï¼Ÿ
A:
- å‡å°‘ `watch_paths` çš„èŒƒå›´
- ä½¿ç”¨ `exclude_patterns` æ’é™¤å¤§å‹ç›®å½•
- å¤§å‹ PDF æ–‡ä»¶è§£æè¾ƒæ…¢ï¼Œå¯ä»¥å…ˆæ’é™¤

### Q: æœç´¢ä¸åˆ°æ–‡æ¡£ï¼Ÿ
A:
1. ç¡®è®¤æ–‡æ¡£å·²è¢«ç´¢å¼•ï¼ˆè¿è¡Œ `npm run index`ï¼‰
2. æ£€æŸ¥ `file_extensions` æ˜¯å¦åŒ…å«ä½ çš„æ–‡ä»¶ç±»å‹
3. å°è¯•ä½¿ç”¨ä¸åŒçš„å…³é”®è¯ï¼ˆæ”¯æŒ SQLite FTS5 è¯­æ³•ï¼‰

### Q: Cherry Studio è¿æ¥å¤±è´¥ï¼Ÿ
A:
1. ç¡®è®¤å·²è¿è¡Œ `npm run build`
2. æ£€æŸ¥é…ç½®ä¸­çš„è·¯å¾„æ˜¯å¦ä¸º**ç»å¯¹è·¯å¾„**
3. æŸ¥çœ‹ Cherry Studio çš„æ—¥å¿—è¾“å‡º

### Q: å¦‚ä½•æ›´æ–°ç´¢å¼•ï¼Ÿ
A:
é‡æ–°è¿è¡Œ `npm run index` å³å¯ã€‚å·²å­˜åœ¨çš„æ–‡æ¡£ä¼šè¢«æ›´æ–°ï¼Œåˆ é™¤çš„æ–‡ä»¶ä¼šè¢«ç§»é™¤ã€‚

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å®šæœŸæ¸…ç†æ•°æ®åº“**: åˆ é™¤ä¸å†éœ€è¦çš„æ–‡æ¡£
2. **åˆç†è®¾ç½®ç›‘æ§è·¯å¾„**: é¿å…ç›‘æ§æ•´ä¸ªç¡¬ç›˜
3. **é™åˆ¶æ–‡ä»¶å¤§å°**: åœ¨ `local-crawler.ts` ä¸­å¯ä»¥æ·»åŠ æ–‡ä»¶å¤§å°é™åˆ¶
4. **ä½¿ç”¨ SSD**: æ•°æ®åº“è®¿é—®é€Ÿåº¦ç›´æ¥å½±å“æœç´¢æ€§èƒ½

## ğŸ›£ï¸ ä¸‹ä¸€æ­¥è®¡åˆ’

**Phase 2: é£ä¹¦é›†æˆ**
1. OAuth è®¤è¯
2. æ–‡æ¡£åˆ—è¡¨è·å–
3. å†…å®¹ä¸‹è½½å’Œè§£æ
4. å¢é‡åŒæ­¥

**Phase 3: ä¼ä¸šå¾®ä¿¡é›†æˆ**
1. è¯„ä¼° API å¯ç”¨æ€§
2. å®ç°æ–‡ä»¶ä¸‹è½½
3. æˆ–é‡‡ç”¨æ‰‹åŠ¨å¯¼å‡ºæ–¹æ¡ˆ

**Phase 4: é«˜çº§æœç´¢**
1. æ¥å…¥æœ¬åœ° Embedding æ¨¡å‹ï¼ˆollamaï¼‰
2. å‘é‡åŒ–æ–‡æ¡£
3. è¯­ä¹‰æœç´¢ + å…³é”®è¯æœç´¢æ··åˆ

## ğŸ“ å¼€å‘è¯´æ˜

```bash
# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨ç¼–è¯‘ï¼‰
npm run dev

# æ‰‹åŠ¨ç¼–è¯‘
npm run build

# ç´¢å¼•æ–‡æ¡£
npm run index

# å¯åŠ¨ MCP Server
npm start
```

## âš ï¸ é‡è¦æç¤º

1. **åˆè§„æ€§**: ç¡®ä¿ç´¢å¼•ä¼ä¸šæ–‡æ¡£ç¬¦åˆå…¬å¸ä¿¡æ¯å®‰å…¨æ”¿ç­–
2. **æƒé™**: æŸäº›æ–‡æ¡£å¯èƒ½éœ€è¦ç®¡ç†å‘˜æˆæƒæ‰èƒ½è®¿é—®
3. **éšç§**: æœ¬åœ°æ•°æ®åº“åŒ…å«æ–‡æ¡£å†…å®¹ï¼Œæ³¨æ„ä¿æŠ¤
4. **å¤‡ä»½**: å®šæœŸå¤‡ä»½ `data/knowledge.db`

## ğŸ“„ è®¸å¯è¯

MIT

---

**é—®é¢˜åé¦ˆ**: å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥æ—¥å¿—è¾“å‡ºå¹¶æä¾›è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚
